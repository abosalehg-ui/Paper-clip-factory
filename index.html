<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <title>Ù…ØµÙ†Ø¹ Ù…Ø´Ø§Ø¨Ùƒ Ø§Ù„ÙˆØ±Ù‚</title>
    <style>
        *{box-sizing:border-box;margin:0;padding:0}
        html,body{height:100%;touch-action:manipulation}
        body{
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
            background: url('background.webp');
            background-size: cover;
            background-attachment: fixed;
            background-repeat: no-repeat;
            background-position: center center;
            background-color: #0b1736;
            background-blend-mode: overlay;
            color:#e6eef8;
            padding:8px;
            min-height:100vh;
            -webkit-font-smoothing:antialiased;
            overflow-x:hidden;
            transition: box-shadow 1s ease-in-out; /* Ø®Ø§ØµÙŠØ© Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² */
            position: relative; /* Ù„ØªÙ…ÙƒÙŠÙ† ÙˆØ¶Ø¹ Ø§Ù„ÙƒØ¤ÙˆØ³ Ø¨Ø´ÙƒÙ„ Ù…Ø·Ù„Ù‚ */
        }
        .container{
            max-width:1200px;
            margin:0 auto;
            /* Ù„ØªØ¹ÙˆÙŠØ¶ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ø£Ø®ÙˆØ°Ø© Ù…Ù† Ø§Ù„Ù€ fixed stats */
            padding-top: 30px;
        }
        .header{
            display: flex; /* ÙŠØ¬Ø¹Ù„ Ø§Ù„Ø¹Ù†Ø§ØµØ± (Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© ÙˆØ§Ù„Ù†Øµ) Ø¹Ù„Ù‰ Ø³Ø·Ø± ÙˆØ§Ø­Ø¯ */
            justify-content: center; /* Ù„ØªÙˆØ³ÙŠØ· Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© ÙˆØ§Ù„Ù†Øµ Ù…Ø¹Ø§Ù‹ Ø£ÙÙ‚ÙŠØ§Ù‹ */
            align-items: center; /* Ù„ØªÙˆØ³ÙŠØ· Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© ÙˆØ§Ù„Ù†Øµ Ø¹Ù…ÙˆØ¯ÙŠØ§Ù‹ (Ù„Ù„ØªØ³Ø§ÙˆÙŠ ÙÙŠ Ø§Ù„Ø§Ø±ØªÙØ§Ø¹) */
            margin:6px 0 10px;
        }
        .title{
            font-size:1.3rem;
            color:#7dd3fc;
            font-weight:700;
            margin-top:0; /* Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ù‡Ø§Ù…Ø´ Ø§Ù„Ø¹Ù„ÙˆÙŠ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØªÙˆØ³ÙŠØ· Ø§Ù„Ø£ÙÙ‚ÙŠ */
            margin-right: 8px; /* Ø¥Ø¶Ø§ÙØ© Ù…Ø³Ø§ÙØ© ÙØ§ØµÙ„Ø© Ø¨ÙŠÙ† Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© ÙˆØ§Ù„Ù†Øµ */
        }
        .subtitle{color:#9aa4b2;margin-top:3px;font-size:0.75rem}

        /* Guide button */
        .guide-btn{
            position: fixed; /* Ù„ØªØ«Ø¨ÙŠØªÙ‡ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø© */
            top: 8px; /* Ù…Ø³Ø§ÙØ© Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ */
            right: auto; /* Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ ØªØ£Ø«ÙŠØ± Ø³Ø§Ø¨Ù‚ Ù„Ù„Ø²Ø§ÙˆÙŠØ© Ø§Ù„ÙŠÙ…Ù†Ù‰ */
            left: 8px; /* Ù…Ø³Ø§ÙØ© Ù…Ù† Ø§Ù„ÙŠØ³Ø§Ø± */
            z-index: 55; /* Ù„Ø¶Ù…Ø§Ù† Ø¸Ù‡ÙˆØ±Ù‡ ÙÙˆÙ‚ Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ */
            
            background:linear-gradient(135deg,#1e40af,#3b82f6);
            border:none;
            width:30px; /* Ø²ÙŠØ§Ø¯Ø© Ø¨Ø³ÙŠØ·Ø© ÙÙŠ Ø§Ù„Ø­Ø¬Ù… Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù„Ù…Ø³ */
            height:30px;
            border-radius:50%;
            cursor:pointer;
            display:inline-flex;
            align-items:center;
            justify-content:center;
            box-shadow:0 3px 8px rgba(59,130,246,0.4);
            transition:transform .2s ease;
        }
        .guide-btn:active{transform:scale(0.95)}
        .guide-btn svg{width:18px;height:18px} /* Ø²ÙŠØ§Ø¯Ø© Ø­Ø¬Ù… Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© */
        
        /* Emoji Icon Styling */
        .emoji-icon{
            font-size: 20px; /* Ø­Ø¬Ù… Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ ÙÙŠ Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
            line-height: 1; /* Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØªÙˆØ³ÙŠØ· Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠ */
            transition: transform .2s;
        }
        .icon-btn:active:not(:disabled) .emoji-icon{transform:scale(1.1)}


        /* Stats grid - FIXED Position */
        .stats-grid{
            display:grid;
            grid-template-columns:repeat(4,1fr);
            gap:5px;
            /* ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Margin-bottom Ù„ØªØ³Ù‡ÙŠÙ„ Ø§Ù„Ù€ Fixed */
            /* margin-bottom:10px; */

            /* NEW: Fixed Position Styles */
            position: fixed;
            top: 8px; /* Ù†ÙØ³ Ù…Ø³ØªÙˆÙ‰ Ø²Ø± Ø§Ù„Ø¯Ù„ÙŠÙ„ ÙˆØ§Ù„ÙƒØ£Ø³ */
            left: 50%;
            transform: translateX(-50%);
            width: calc(100% - 16px); /* 100% minus 8px padding on each side of body */
            max-width: 1200px;
            z-index: 50; /* Above regular content */
            /* Ø§Ù„Ø´ÙØ§ÙÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© */
            background: #071033e6; /* Semi-transparent background to blend with body but be visible */
            padding: 5px 8px; /* Top/Bottom padding for the fixed container */
            border-radius: 8px; /* ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø²ÙˆØ§ÙŠØ§ Ù„ØªÙƒÙˆÙ† Ù…Ø±Ø¨Ø¹Ø© Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ù‡Ø§Øª */
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            /* End NEW: Fixed Position Styles */
        }
        .stat-card{
            background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
            padding:2px;
            border-radius:8px;
            border:1px solid rgba(255,255,255,0.06);
            backdrop-filter:blur(4px);
            box-shadow:0 3px 12px rgba(2,6,23,0.5);
            text-align:center;
        }
        .stat-icon{
            width:12px;
            height:12px;
            margin:0 auto 2px;
            display:grid;
            place-items:center;
            border-radius:6px;
            background:rgba(255,255,255,0.03);
        }
        .stat-icon .emoji-icon-stat{
            font-size: 10px; /* Ø­Ø¬Ù… Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ ÙÙŠ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© */
        }
        .stat-label{color:#9aa4b2;font-size:0.50rem;margin-bottom:1px}
        .stat-value{font-size:0.70rem;font-weight:700}

        /* Main sections */
        .main-grid{display:flex;flex-direction:column;gap:8px;margin-bottom:10px}
        .section{
            background:linear-gradient(145deg,#0f1724,#1a1f2e);
            padding:8px;
            border-radius:10px;
            border:1px solid rgba(125,211,252,0.08);
            box-shadow:0 6px 20px rgba(0,0,0,0.4);
        }
        .section-title{
            font-size:0.85rem;
            font-weight:700;
            margin-bottom:6px;
            display:flex;
            align-items:center;
            gap:5px;
            justify-content:center;
        }
        .section-title .emoji-icon-section{
            font-size: 14px;
        }

        /* Buttons */
        .icon-btn{
            width:100%;
            min-height:45px;
            border:none;
            border-radius:10px;
            cursor:pointer;
            transition:all .2s ease;
            position:relative;
            overflow:hidden;
            display:flex;
            flex-direction:column;
            align-items:center;
            justify-content:center;
            gap:3px;
            padding:6px;
            box-shadow:0 4px 15px rgba(0,0,0,0.3);
            font-weight:700;
            font-size:0.75rem;
        }
        .icon-btn:active:not(:disabled){transform:scale(0.97)}
        .icon-btn:disabled{opacity:.4;cursor:not-allowed}
        .icon-btn svg{width:22px;height:22px;transition:transform .2s} /* Ø§Ù„Ø¥Ø¨Ù‚Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù€ SVG Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ ÙˆØ§Ù„Ø¯Ù„ÙŠÙ„ ÙÙ‚Ø· */
        .icon-btn:active:not(:disabled) svg{transform:scale(1.1)}

        .btn-make{background:linear-gradient(135deg,#2563eb,#1d4ed8);color:#fff}
        .btn-make:before{content:'';position:absolute;inset:0;background:linear-gradient(135deg,rgba(255,255,255,0.1),transparent);opacity:0;transition:opacity .2s}
        .btn-make:active:not(:disabled):before{opacity:1}
        .btn-sell{background:linear-gradient(135deg,#16a34a,#15803d);color:#fff}
        .btn-buy{background:linear-gradient(135deg,#f59e0b,#d97706);color:#fff}
        .btn-upgrade{background:linear-gradient(135deg,#8b5cf6,#7c3aed);color:#fff}
        .btn-marketing{background:linear-gradient(135deg,#a855f7,#9333ea);color:#fff}
        .btn-secondary{background:linear-gradient(135deg,#1e3a8a,#1e40af);color:#fff}

        /* Item boxes */
        .item-box{
            background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.005));
            padding:6px;
            border-radius:8px;
            margin-bottom:6px;
            border:1px solid rgba(255,255,255,0.04);
        }
        .item-header{
            display:flex;
            justify-content:space-between;
            align-items:center;
            margin-bottom:5px;
            font-size:0.7rem;
        }
        .item-info{
            color:#9aa4b2;
            font-size:0.65rem;
            margin-bottom:5px;
            text-align:center;
        }

        /* Price controls */
        .price-container{
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 5px; /* Spacing between button and display */
        }
        .price-display{
            flex-grow: 1; /* Allow price display to take up available space */
            text-align:center;
            padding:4px;
            background:rgba(16,185,129,0.1);
            border-radius:8px;
            border:1px solid rgba(16,185,129,0.2);
        }
        .price-label{color:#9aa4b2;font-size:0.65rem;margin-bottom:2px}
        .price-value{font-size:1.2rem;font-weight:700;color:#10b981}

        /* Price control buttons - now single buttons */
        .price-btn{
            width: 50px;
            min-height:50px;
            border:none;
            border-radius:8px;
            background:linear-gradient(135deg,#0d9488,#0f766e);
            color:#fff;
            font-size:0.9rem;
            font-weight:700;
            cursor:pointer;
            display:flex;
            flex-direction:column;
            align-items:center;
            justify-content:center;
            gap:2px;
            box-shadow:0 3px 10px rgba(13,148,136,0.3);
            transition:transform .2s;
        }
        .price-btn:active{transform:scale(0.95)}
        /* NEW: SVG styling for price buttons */
        .price-btn svg{width:20px;height:20px;stroke:#fff}
        .price-btn span{font-size:0.65rem;opacity:0.9; display: none;} /* Hide the label */

        /* Toggle */
        .toggle-container{
            display:flex;
            align-items:center;
            justify-content:space-between;
            padding:6px;
            background:rgba(255,255,255,0.02);
            border-radius:8px;
            margin-bottom:6px;
            font-size:0.7rem;
        }
        .toggle-btn{
            width:45px;
            height:24px;
            border-radius:12px;
            border:none;
            cursor:pointer;
            position:relative;
            transition:background .3s;
            box-shadow:inset 0 2px 6px rgba(0,0,0,0.3);
        }
        .toggle-on{background:#10b981}
        .toggle-off{background:#475569}
        .toggle-btn:after{
            content:''; 
            position:absolute;
            width:18px;
            height:18px;
            border-radius:50%;
            background:#fff;
            top:3px;
            transition:right .3s;
            box-shadow:0 2px 4px rgba(0,0,0,0.3);
        }
        .toggle-off:after{right:24px}
        .toggle-on:after{right:3px}

        /* Stats section */
        .stats-section{
            display:grid;
            grid-template-columns:repeat(2,1fr);
            gap:6px;
        }
        .stat-item{text-align:center;padding:5px}
        .stat-item-label{color:#9aa4b2;font-size:0.6rem;margin-bottom:2px}
        .stat-item-value{font-size:0.85rem;font-weight:700}

        /* Animations */
        .pulse{animation:pulse 2s infinite}
        @keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.04)}100%{transform:scale(1)}}
        .float{animation:float 3.4s ease-in-out infinite}
        @keyframes float{0%{transform:translateY(0)}50%{transform:translateY(-5px)}100%{transform:translateY(0)}}
        .glow-update{animation:glow .9s ease}
        @keyframes glow{0%{box-shadow:0 0 0 rgba(125,211,252,0)}50%{box-shadow:0 0 15px rgba(125,211,252,0.4)}100%{box-shadow:0 0 0 rgba(125,211,252,0)}}
        
        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ Ø§Ù„Ù…ØªØ·Ø§ÙŠØ±Ø© - ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù‡Ù†Ø§ */
        .floating-emoji {
            position: absolute;
            font-size: 1.5rem;
            opacity: 0;
            pointer-events: none;
            user-select: none;
            z-index: 100;
            animation: floatAndFade 1.2s ease-out forwards;
        }

        @keyframes floatAndFade {
            0% {
                transform: translate(-50%, 0) scale(0.7);
                opacity: 1;
            }
            50% {
                transform: translate(-50%, -100%) scale(1.1);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -200%) scale(0.5);
                opacity: 0;
            }
        }
        /* Ù†Ù‡Ø§ÙŠØ© ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ Ø§Ù„Ù…ØªØ·Ø§ÙŠØ±Ø© */

        /* Modal */
        .modal{
            display:none;
            position:fixed;
            inset:0;
            background:rgba(2,6,23,0.95);
            align-items:center;
            justify-content:center;
            padding:12px;
            z-index:60;
            backdrop-filter:blur(8px);
        }
        .modal.active{display:flex}
        .modal-content{
            background:linear-gradient(145deg,#071022,#0a1628);
            padding:16px;
            border-radius:12px;
            border:2px solid rgba(125,211,252,0.1);
            max-width:500px;
            width:100%;
            max-height:90vh;
            overflow:auto;
        }
        .modal-title{
            text-align:center;
            color:#7dd3fc;
            margin-bottom:12px;
            font-size:1.3rem;
        }
        .guide-section{
            background:#061427;
            padding:10px;
            border-radius:10px;
            margin-bottom:10px;
            border:1px solid rgba(255,255,255,0.04);
        }
        .guide-section h3{
            color:#60a5fa;
            margin-bottom:6px;
            font-size:0.9rem;
        }
        .guide-section ul,.guide-section p{
            list-style:none;
            padding:0;
            color:#cbd5e1;
            font-size:0.8rem;
            line-height:1.5;
        }
        .guide-section ul li{margin-bottom:5px}

        .dev-info{
            text-align:center;
            padding:10px;
            border-radius:8px;
            background:linear-gradient(90deg,#071433,#0b1b2c);
            border:1px solid rgba(125,211,252,0.06);
            margin-top:10px;
            font-size:0.8rem;
        }
        
        /* New Challenge Modal Styles */
        /* ØªØ¹Ø¯ÙŠÙ„ ØªØµÙ…ÙŠÙ… Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ø­ÙˆØ§Ø¯Ø« Ù„ÙŠØªØ·Ø§Ø¨Ù‚ Ù…Ø¹ modal Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        #challengeModal .modal-content {
            border: 2px solid rgba(239, 68, 68, 0.4); /* Ù„ÙˆÙ† Ø£Ø­Ù…Ø± Ø¨Ø§Ù‡Øª Ù„Ù„Ø­Ø§ÙØ© */
            background: linear-gradient(145deg, #071022,#0a1628); /* Ù†ÙØ³ Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.3); /* Ø¸Ù„ Ø£Ø­Ù…Ø± Ù„Ù„ØªÙ†Ø¨ÙŠÙ‡ */
        }
        #challengeModal .modal-title {
            color: #ef4444; /* Ù„ÙˆÙ† Ø£Ø­Ù…Ø± Ù„Ù„Ø¹Ù†ÙˆØ§Ù† */
            font-weight: 700;
        }
        #challengeModal .modal-content strong {
            color: #fca5a5;
        }
        
        /* Game Over Modal Styles - New */
        #gameOverModal .modal-content {
            border: 2px solid rgba(255, 255, 255, 0.4);
            background: linear-gradient(145deg, #071022,#0a1628);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        }

        #insuranceTimer {
            text-align: center;
            font-size: 0.8rem;
            font-weight: bold;
            color: #fca5a5;
            margin-top: -6px;
            margin-bottom: 6px;
        }


        /* TROPHY Styles - Full Page Glow */
        .trophy-bronze {
            box-shadow: 0 0 30px 10px rgba(176, 141, 87, 0.7), inset 0 0 20px rgba(176, 141, 87, 0.5);
        }
        .trophy-silver {
            box-shadow: 0 0 40px 15px rgba(192, 192, 192, 0.8), inset 0 0 30px rgba(192, 192, 192, 0.6);
        }
        .trophy-gold {
            box-shadow: 0 0 50px 20px rgba(255, 215, 0, 0.9), inset 0 0 40px rgba(255, 215, 0, 0.7);
        }

        /* TROPHY Icon Styles (PNG Version) */
        .trophy-icon {
            position: fixed;
            top: 8px;
            right: 8px;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            box-shadow: 0 4px 15px rgba(0,0,0,0.4);
            z-index: 56;
            display: none; /* Ù…Ø®ÙÙŠ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ */
            animation: bounceIn 0.8s ease-out forwards;
            background: transparent;

            /* Ø®ØµØ§Ø¦Øµ PNG */
            background-size: 25px 25px; /* Ø­Ø¬Ù… Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© - ÙƒØ§Ù† 25px Ù„Ù„Ø³ÙØ¬ */
            background-repeat: no-repeat;
            background-position: center;
        }

        /* Bronze Trophy Icon - Use background-image for PNG and gradient for color */
        #trophyBronzeIcon {
            background-image: url('trophy-bronze.png');
        }

        /* Silver Trophy Icon */
        #trophySilverIcon {
            background-image: url('trophy-silver.png');
        }

        /* Gold Trophy Icon */
        #trophyGoldIcon {
            background-image: url('trophy-gold.png');
        }

        @keyframes bounceIn {
            0% {
                transform: scale(0.3);
                opacity: 0;
            }
            50% {
                transform: scale(1.1);
                opacity: 1;
            }
            70% {
                transform: scale(0.9);
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* Record Notification (Gold gradient, slide + fade) */
        .record-notification {
            position: fixed;
            top: -80px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #facc15, #ca8a04);
            color: #1b1b1b;
            padding: 12px 20px;
            border-radius: 14px;
            font-weight: 800;
            font-size: 0.95rem;
            box-shadow: 0 8px 30px rgba(202,138,4,0.25);
            z-index: 999;
            transition: top 0.45s cubic-bezier(.2,.9,.2,1), opacity 0.9s ease;
            opacity: 0;
            display: flex;
            align-items: center;
            gap:10px;
            border: 1px solid rgba(0,0,0,0.08);
            text-align: center;
        }
        .record-notification.show {
            top: 12px;
            opacity: 1;
        }
        .record-notification.fade-out {
            opacity: 0;
            top: -40px;
        }
        .record-notification .emoji {
            font-size:1.2rem;
            filter: drop-shadow(0 2px 6px rgba(0,0,0,0.15));
        }

        /* TROPHY Icon Styles (PNG Version) */
        /* Tablet & Desktop */
        @media (min-width:768px){
            .stats-grid{
                gap:6px;
                padding: 4px 6px; /* Increase padding for fixed header on desktop */
                top: 8px; /* Keep the top position the same for fixed header */
            }
            .container{
                padding-top: 50px; /* Increase compensation for fixed header on desktop */
            }
            .stat-card{padding:5px}
            .stat-icon{width:20px;height:20px;margin-bottom:2px}
            .stat-icon .emoji-icon-stat{font-size: 16px;}
            .stat-label{font-size:0.6rem;margin-bottom:2px}
            .stat-value{font-size:1rem}
            .main-grid{grid-template-columns:repeat(2,1fr);gap:16px}
            .section{padding:14px}
            .title{font-size:2rem}
            .icon-btn{min-height:70px;font-size:0.9rem}
            .icon-btn .emoji-icon{font-size: 30px;}
            .section-title{font-size:1rem}
            .section-title .emoji-icon-section{font-size: 20px;}
            .price-btn {
                width: 60px; /* Wider button for desktop */
            }
            .price-btn svg{width:25px;height:25px;} /* Larger SVG for desktop */
        }
    </style>
</head>
<body>
            <button class="guide-btn" onclick="toggleGuide()">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none">
                    <circle cx="12" cy="12" r="10" stroke="#fff" stroke-width="2"/>
                    <path d="M12 16v-4M12 8h.01" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
    <audio id="clickSound" src="click.mp3" preload="auto"></audio>
    <audio id="cashSound" src="cash.mp3" preload="auto"></audio>
    <audio id="buySound" src="buy.mp3" preload="auto"></audio>
    <audio id="trophySound" src="Trophy.mp3" preload="auto"></audio>
    <audio id="warningSound" src="warning.mp3" preload="auto"></audio>
    <audio id="fireSound" src="fire.mp3" preload="auto"></audio>
    <audio id="failSound" src="fail.mp3" preload="auto"></audio>
    <audio id="completionSound" src="completion.mp3" preload="auto"></audio>

    <div id="trophyBronzeIcon" class="trophy-icon"></div>
    <div id="trophySilverIcon" class="trophy-icon"></div>
    <div id="trophyGoldIcon" class="trophy-icon"></div>

    <div id="recordNotification" class="record-notification" aria-live="polite" role="status">
        <span class="emoji">ğŸ‰</span>
        <span>ğŸ‰ Ø±Ù‚Ù… Ù‚ÙŠØ§Ø³ÙŠ Ø¬Ø¯ÙŠØ¯! ØªÙ… ØªØ­Ø·ÙŠÙ… Ø£ÙØ¶Ù„ Ù…Ø¨ÙŠØ¹Ø§ØªÙƒ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©!</span>
    </div>

    <div class="container">
        <div class="header">
            <h1 class="title"></h1> 
        </div>

        <div class="stats-grid">
            <div class="stat-card" id="card-clips">
                <div class="stat-icon">
                    <span class="emoji-icon-stat">ğŸ“</span>
                </div>
                <div class="stat-label">Ø§Ù„Ù…Ø´Ø§Ø¨Ùƒ (<span id="clipsLimit">5,000</span>)</div>
                <div class="stat-value" id="clips">0</div>
            </div>

            <div class="stat-card" id="card-money">
                <div class="stat-icon">
                    <span class="emoji-icon-stat">ğŸ’µ</span>
                </div>
                <div class="stat-label">Ø§Ù„Ù…Ø§Ù„</div>
                <div class="stat-value">$<span id="money">0.00</span></div>
            </div>

            <div class="stat-card" id="card-wire">
                <div class="stat-icon">
                    <span class="emoji-icon-stat">ğŸ§µ</span>
                </div>
                <div class="stat-label">Ø§Ù„Ø³Ù„Ùƒ</div>
                <div class="stat-value" id="wire">1000</div>
            </div>

            <div class="stat-card" id="card-demand">
                <div class="stat-icon">
                    <span class="emoji-icon-stat">ğŸ“ˆ</span>
                </div>
                <div class="stat-label">Ø§Ù„Ø·Ù„Ø¨</div>
                <div class="stat-value" id="demand">50</div>
            </div>
        </div>

        <div class="main-grid">
            <div class="section">
                <div class="section-title" style="color:#7dd3fc">
                    <span class="emoji-icon-section">ğŸ­</span>
                    Ù…ØµÙ†Ø¹ Ù…Ø´Ø§Ø¨Ùƒ Ø§Ù„ÙˆØ±Ù‚
                </div>

                <button id="makeBtn" class="icon-btn btn-make" onclick="makeClip()">
                    <span class="emoji-icon">ğŸ“</span>
                    <span id="makeBtnText">ØµÙ†Ø¹ Ù…Ø´Ø¨Ùƒ</span>
                </button>

                <div class="item-box">
                    <div class="item-header">
                        <span>Ø¢Ù„Ø§Øª ØµÙ†Ø¹ ØªÙ„Ù‚Ø§Ø¦ÙŠ</span>
                        <span style="color:#60a5fa;font-weight:700" id="autoClippers">0</span>
                    </div>
                    <button id="autoClipperBtn" class="icon-btn btn-secondary" onclick="buyAutoClipper()">
                        <span class="emoji-icon">ğŸ¤–</span>
                        <span>Ø´Ø±Ø§Ø¡ Ø¢Ù„Ø© $<span id="autoClipperCost">5.00</span></span>
                    </button>
                </div>

                <div class="item-box">
                    <div class="item-header">
                        <span>Ø´Ø±Ø§Ø¡ Ø³Ù„Ùƒ</span>
                        <span style="color:#f59e0b;font-weight:700">Ø´Ø±Ø§Ø¡ Ø³Ù„Ùƒ (1000 ÙˆØ­Ø¯Ø©)</span>
                    </div>
                    <button id="wireBtn" class="icon-btn btn-buy" onclick="buyWire()">
                        <span class="emoji-icon">ğŸ“¦</span>
                        <span>$<span id="wireCost">20.00</span></span>
                    </button>
                </div>
            </div>

            <div class="section">
                <div class="section-title" style="color:#86efac">
                    <span class="emoji-icon-section">ğŸ›’</span>
                    Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª
                </div>
                
                <div class="price-container">
                    <button id="decreasePriceBtn" class="price-btn" 
                            onmousedown="startPriceAdjust(-0.01)" 
                            ontouchstart="startPriceAdjust(-0.01)" 
                            onmouseup="stopPriceAdjust()" 
                            ontouchend="stopPriceAdjust()"
                            ontouchcancel="stopPriceAdjust()">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="3">
                            <path d="M12 5v14M19 12l-7 7-7-7"/>
                        </svg>
                    </button>
                    
                    <div class="price-display">
                        <div class="price-label">Ø§Ù„Ø³Ø¹Ø±</div>
                        <div class="price-value">$<span id="price">0.25</span></div>
                    </div>

                    <button id="increasePriceBtn" class="price-btn" 
                            onmousedown="startPriceAdjust(0.01)" 
                            ontouchstart="startPriceAdjust(0.01)" 
                            onmouseup="stopPriceAdjust()" 
                            ontouchend="stopPriceAdjust()"
                            ontouchcancel="stopPriceAdjust()">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="3">
                            <path d="M12 19V5M5 12l7-7 7 7"/>
                        </svg>
                    </button>
                </div>
                <button id="sellBtn" class="icon-btn btn-sell" onclick="sellClips()" style="margin-top:6px">
                    <span class="emoji-icon">ğŸ’°</span>
                    <span>Ø¨ÙŠØ¹ Ø§Ù„Ù…Ø´Ø§Ø¨Ùƒ (Ù…ØªÙˆÙØ±: <span id="availableClips">0</span>)</span>
                </button>

                <div class="toggle-container">
                    <span>Ø¨ÙŠØ¹ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ù…Ø´Ø§Ø¨Ùƒ</span>
                    <button id="autoSellBtn" class="toggle-btn toggle-off" onclick="toggleAutoSell()"></button>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-title" style="color:#fbbf24">
                <span class="emoji-icon-section">âœ¨</span>
                Ø§Ù„ØªØ±Ù‚ÙŠØ§Øª
            </div>

            <div class="item-box">
                <div class="item-header">
                    <span>ØªØ±Ù‚ÙŠØ© Ø§Ù„ØªØ³ÙˆÙŠÙ‚</span>
                    <span style="color:#a78bfa;font-weight:700">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ <span id="marketingLevel">1</span></span>
                </div>
                <button id="marketingBtn" class="icon-btn btn-marketing" onclick="increaseMarketing()">
                    <span class="emoji-icon">ğŸ“£</span>
                    <span> $<span id="marketingCost">100.00</span></span>
                </button>
            </div>
            
            <div class="item-box">
                <div class="item-header">
                    <span>ØªÙˆØ³Ø¹Ø© Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ù„Ù€ 5,000 Ù…Ø´Ø¨Ùƒ Ø¥Ø¶Ø§ÙÙŠØ©</span>
                    <span style="color:#f59e0b;font-weight:700">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: <span id="clipsLimitCurrent">5,000</span></span>
                </div>
                <button id="warehouseBtn" class="icon-btn btn-upgrade" onclick="upgradeWarehouse()">
                    <span class="emoji-icon">ğŸ“¦</span>
                    <span> $<span id="warehouseCost">50.00</span></span>
                </button>
            </div>
            <div class="item-box">
                <div class="item-header">
                    <span>Ø²ÙŠØ§Ø¯Ø© ÙƒÙØ§Ø¡Ø© Ø§Ù„Ø³Ù„Ùƒ</span>
                    <span style="color:#fbbf24;font-weight:700">Ã—<span id="wireEfficiency">1.0</span></span>
                </div>
                <button id="efficiencyBtn" class="icon-btn btn-upgrade" onclick="buyWireEfficiency()">
                    <span class="emoji-icon">âš™ï¸</span>
                    <span> $<span id="efficiencyCost">1000.00</span></span>
                </button>
            </div>

            <div class="item-box">
                <div class="item-header">
                    <span>ØªÙˆØ³Ø¹Ø© Ø§Ù„Ù…ØµÙ†Ø¹ Ù„Ù€ 100 Ø¢Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©</span>
                    <span style="color:#7dd3fc;font-weight:700">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: <span id="maxClippers">100</span></span>
                </div>
                <button id="expansionBtn" class="icon-btn btn-secondary" onclick="buyExpansion()">
                    <span class="emoji-icon">ğŸ—ï¸</span>
                    <span> $<span id="expansionCost">2000.00</span></span>
                </button>
            </div>

            <div class="item-box">
                <div class="item-header">
                    <span>ØªØ£Ù…ÙŠÙ† Ø§Ù„Ù…ØµÙ†Ø¹ Ù…Ù† Ø§Ù„Ø­ÙˆØ§Ø¯Ø« Ù„Ù…Ø¯Ø© 5 Ø¯Ù‚Ø§Ø¦Ù‚</span>
                    <span style="color:#8b5cf6;font-weight:700">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ <span id="insuranceLevel">0</span></span>
                </div>
                <div id="insuranceTimer"></div>
                <button id="insuranceBtn" class="icon-btn btn-upgrade" onclick="buyInsurance()">
                    <span class="emoji-icon">ğŸ›¡ï¸</span>
                    <span> $<span id="insuranceCost">1000.00</span></span>
                </button>
            </div>

        </div>

        <div class="section">
            <div class="section-title" style="color:#cbd5e1">
                <span class="emoji-icon-section">ğŸ“Š</span>
                Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            </div>
            <div class="stats-section">
                <div class="stat-item">
                    <div class="stat-item-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬</div>
                    <div class="stat-item-value" id="totalClips">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-item-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</div>
                    <div class="stat-item-value" id="totalSold">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-item-label">Ø§Ù„Ø¢Ù„Ø§Øª</div>
                    <div class="stat-item-value" id="totalMachines">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-item-label">Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø¥Ù†ØªØ§Ø¬</div>
                    <div class="stat-item-value"><span id="productionRate">0</span>/Ø«</div>
                </div>
            </div>
        </div>

        <div class="section" id="localLeaderboardSection" style="margin-top:12px;">
            <div class="section-title" style="color:#ffd166">
                <span class="emoji-icon-section">ğŸ…</span>
                Ø£ÙØ¶Ù„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…Ø­Ù„ÙŠØ©
            </div>

            <div class="item-box" style="text-align:center;">
                <div style="font-weight:700; font-size:1rem; color:#fff; margin-bottom:6px;">ğŸ¥‡ Ø£ÙØ¶Ù„ Ù†ØªÙŠØ¬Ø©</div>
                <div id="bestInfo" style="color:#cbd5e1; font-size:0.95rem;">
                    <div>Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª: <span id="bestTotalSold">0</span> Ù…Ø´Ø¨Ùƒ</div>
                    <div style="margin-top:6px;">Ø§Ù„Ù…Ø§Ù„: $<span id="bestMoney">0.00</span></div>
                    <div style="margin-top:6px; color:#9aa4b2; font-size:0.8rem;">Ø§Ù„ØªØ§Ø±ÙŠØ®: <span id="bestDate">â€”</span></div>
                </div>

                <div style="display:flex; gap:8px; margin-top:12px;">
                    <button class="icon-btn btn-secondary" onclick="resetBestScore()" style="flex:1; min-height:44px;">
                        Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…Ø­Ù„ÙŠØ©
                    </button>
                    <button class="icon-btn btn-make" onclick="exportBestScore()" style="flex:1; min-height:44px;">
                        ØªØµØ¯ÙŠØ± (Ù†Ø³Ø®)
                    </button>
                </div>

                <div style="margin-top:10px; color:#9aa4b2; font-size:0.75rem;">
                    ØªÙØ¨Ù†Ù‰ Ø§Ù„Ù„ÙˆØ­Ø© Ø¹Ù„Ù‰ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª <strong>(totalSold)</strong>. ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ø§Ù„ Ø¹Ù†Ø¯ ØªØ­Ø·ÙŠÙ… Ø±Ù‚Ù… Ù‚ÙŠØ§Ø³ÙŠ.
                </div>
            </div>
        </div>

    </div>

    <div id="gameOverModal" class="modal">
        <div class="modal-content">
            <h2 class="modal-title" style="color: #ef4444;">Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©! ğŸ›‘</h2>
            <p style="text-align:center;color:#cbd5e1;margin-bottom:15px;" id="gameOverMessage">
                Ù„Ù‚Ø¯ Ù†ÙØ¯ Ù…Ù†Ùƒ Ø§Ù„Ø³Ù„Ùƒ ÙˆÙ„Ø§ ØªÙ…Ù„Ùƒ Ø§Ù„Ù…Ø§Ù„ Ø§Ù„ÙƒØ§ÙÙŠ Ù„Ø´Ø±Ø§Ø¡ Ø§Ù„Ù…Ø²ÙŠØ¯ØŒ ÙˆÙ„Ø§ ÙŠÙˆØ¬Ø¯ Ù„Ø¯ÙŠÙƒ Ù…Ø´Ø§Ø¨Ùƒ Ù„Ø¨ÙŠØ¹Ù‡Ø§.
            </p>
            <div class="dev-info" style="margin-top:0; border:none; background:none;">
                <div style="font-weight:700;color:#e6eef8">Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: $<span id="finalMoney">0.00</span></div>
                <div style="margin-top:3px; font-size:0.75rem; color:#9aa4b2">ØªÙ… Ø¨ÙŠØ¹: <span id="finalSold">0</span> Ù…Ø´Ø¨Ùƒ</div>
            </div>
            <button class="icon-btn btn-make" onclick="location.reload()" style="width:100%;background:linear-gradient(135deg,#2563eb,#1d4ed8); margin-top:15px;">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none">
                    <path d="M12 4v16M5 11l7-7 7 7" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨</span>
            </button>
        </div>
    </div>
    
    <div id="challengeModal" class="modal">
        <div class="modal-content">
            <h2 class="modal-title" id="challengeTitle">Ø­Ø§Ø¯Ø«!</h2>
            <p style="text-align:center;color:#cbd5e1;margin-bottom:15px;" id="challengeMessage">
                ØªÙ…Øª Ø³Ø±Ù‚Ø© 500 Ø¯ÙˆÙ„Ø§Ø± Ù…Ù† Ø§Ù„Ù…ØµÙ†Ø¹ Ø¨Ø³Ø¨Ø¨ Ø«ØºØ±Ø© Ø£Ù…Ù†ÙŠØ©!
            </p>
            <button class="icon-btn btn-make" onclick="closeChallengeModal()" style="width:100%;background:linear-gradient(135deg,#ef4444,#dc2626)">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none">
                    <path d="M6 18L18 6M6 6l12 12" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>Ø­Ø³Ù†Ø§Ù‹</span>
            </button>
        </div>
    </div>
    
    <div id="guideModal" class="modal">
        <div class="modal-content">

            <div class="guide-section">
                <h3>ğŸ® ÙƒÙŠÙÙŠØ© Ø§Ù„Ù„Ø¹Ø¨</h3>
                <ul>
                    <li>â€¢ Ø§Ø¶ØºØ· ØµÙ†Ø¹ Ù…Ø´Ø¨Ùƒ Ù„ØµÙ†Ø¹ Ù…Ø´Ø¨Ùƒ ÙˆØ§Ø­Ø¯ (ÙŠØ³ØªÙ‡Ù„Ùƒ Ø³Ù„Ùƒ).</li>
                    <li>â€¢ Ø¨ÙŠØ¹ Ø§Ù„Ù…Ø´Ø§Ø¨Ùƒ Ù„ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø§Ù„. Ø§Ù„Ø³Ø¹Ø± ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨.</li>
                    <li>â€¢ Ø§Ø´ØªØ±Ù Ø³Ù„Ùƒ ÙˆØ¢Ù„Ø§Øª Ù„ØªØ±ÙØ¹ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©ØŒ ÙˆÙˆØ³Ø¹ Ù…ØµÙ†Ø¹Ùƒ.</li>
                </ul>
            </div>

            <div class="guide-section">
                <h3>âš¡ Ø§Ù„Ø£ØªÙ…ØªØ©</h3>
                <ul>
                    <li>â€¢ Ø§Ù„Ø¢Ù„Ø© ØªÙ†ØªØ¬ Ù…Ø´Ø§Ø¨Ùƒ ÙƒÙ„ Ø«Ø§Ù†ÙŠØ©.</li>
                    <li>â€¢ ÙØ¹Ù‘Ù„ Ø§Ù„Ø¨ÙŠØ¹ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø¨ÙŠØ¹ Ø¨Ø¯ÙˆÙ† Ø¶ØºØ· Ù…Ù†Ùƒ.</li>
                </ul>
            </div>

            <div class="guide-section">
                <h3>ğŸš€ Ø§Ù„ØªØ±Ù‚ÙŠØ§Øª</h3>
                <ul>
                    <li>â€¢ Ø²ÙŠØ§Ø¯Ø© ÙƒÙØ§Ø¡Ø© Ø§Ù„Ø³Ù„Ùƒ ØªØ¹Ø·ÙŠÙƒ Ø³Ù„Ùƒ Ø£ÙƒØ«Ø± Ø¹Ù†Ø¯ Ø§Ù„Ø´Ø±Ø§Ø¡.</li>
                    <li>â€¢ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ ÙŠØ²ÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ù„Ù‰ Ù…Ù†ØªØ¬Ø§ØªÙƒ.</li>
                    <li>â€¢ Ø§Ù„ØªØ£Ù…ÙŠÙ† ÙŠÙ‚ÙÙ„ Ø§Ù„Ø­ÙˆØ§Ø¯Ø« Ø§Ù„Ø³Ø±Ù‚Ø© ÙˆØ§Ù„Ø­Ø±ÙŠÙ‚ Ù…Ø¤Ù‚ØªØ§Ù‹.</li>
                    <li>â€¢ ØªÙˆØ³Ø¹Ø© Ø§Ù„Ù…ØµÙ†Ø¹ ÙˆØªØ±Ù‚ÙŠØ© Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ ØªØªÙŠØ­ Ù…Ø³Ø§Ø­Ø© Ø¥Ø¶Ø§ÙÙŠØ©.</li>
                </ul>
            </div>

            <div class="dev-info">
                <div style="font-weight:700;color:#e6eef8">Ø§Ù„Ù…Ø·ÙˆØ± â€” ABDULKARIM ALOBUD</div>
                <div style="margin-top:6px"><a href="mailto:abo.saleh.g@gmail.com" style="color:#60a5fa;text-decoration:none">abo.saleh.g@gmail.com</a></div>
            </div>

            <div style="margin-top:16px">
                <button class="icon-btn btn-make" onclick="toggleGuide()" style="width:100%">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none">
                        <path d="M5 12h14M12 5l7 7-7 7" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span>Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        let gameState = {
            clips: 0,
            money: 0,
            price: 0.25,
            demand: 50,
            wire: 1000,
            wireCost: 20,
            autoClippers: 0,
            autoClipperCost: 5,
            autoClipperRate: 0,
            wireEfficiency: 1,
            marketingLevel: 1,
            autoSellEnabled: false,
            totalClips: 0,
            totalSold: 0,
            // Ø§Ù„Ø¥Ø¶Ø§ÙØ§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
            insuranceLevel: 0,
            insuranceCost: 1000,
            insuranceEndTime: 0, // Timestamp of when insurance expires
            maxClippersLimit: 100, // Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ø¢Ù„Ø§Øª Ø§Ù„ØµÙ†Ø¹
            expansionCost: 2000, // ØªÙƒÙ„ÙØ© Ø§Ù„ØªÙˆØ³Ø¹Ø© Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
            
            // NEW: ØªÙˆØ³Ø¹Ø© Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹
            maxClipsLimit: 5000, // Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ø§Ù„Ù…Ø¨Ø¯Ø¦ÙŠ Ù„Ù„Ù…Ø´Ø§Ø¨Ùƒ
            warehouseCost: 100, // ØªÙƒÙ„ÙØ© ØªØ±Ù‚ÙŠØ© Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ù…Ø¨Ø¯Ø¦ÙŠØ©
            
            // Ø­Ø§Ù„Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª
            trophyBronze: false,
            trophySilver: false,
            trophyGold: false
        };

        // Best local score object (loaded from localStorage)
        let bestLocalScore = {
            totalSold: 0,
            money: 0,
            date: null
        };

        const clickSound = document.getElementById('clickSound');
        const cashSound = document.getElementById('cashSound');
        const buySound = document.getElementById('buySound');
        const trophySound = document.getElementById('trophySound');
        const warningSound = document.getElementById('warningSound');
        const fireSound = document.getElementById('fireSound');
        const failSound = document.getElementById('failSound'); // NEW: Fail Sound
        const completionSound = document.getElementById('completionSound'); // NEW: completion.mp3

        // Ø¹Ù†Ø§ØµØ± Ø§Ù„ÙƒØ¤ÙˆØ³
        const trophyBronzeIcon = document.getElementById('trophyBronzeIcon');
        const trophySilverIcon = document.getElementById('trophySilverIcon');
        const trophyGoldIcon = document.getElementById('trophyGoldIcon');
        
        // Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø­ÙˆØ§Ø¯Ø«
        const challengeModal = document.getElementById('challengeModal');
        const challengeTitle = document.getElementById('challengeTitle');
        const challengeMessage = document.getElementById('challengeMessage');
        const insuranceTimerEl = document.getElementById('insuranceTimer');
        
        // Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø®Ø³Ø§Ø±Ø© (NEW)
        const gameOverModal = document.getElementById('gameOverModal');
        const finalMoneyEl = document.getElementById('finalMoney');
        const finalSoldEl = document.getElementById('finalSold');

        // Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ©
        const recordNotificationEl = document.getElementById('recordNotification');
        const bestTotalSoldEl = document.getElementById('bestTotalSold');
        const bestMoneyEl = document.getElementById('bestMoney');
        const bestDateEl = document.getElementById('bestDate');
        
        const makeBtn = document.getElementById('makeBtn'); // ØªÙ… Ø¬Ù„Ø¨ Ø²Ø± Ø§Ù„ØµÙ†Ø¹
        const sellBtn = document.getElementById('sellBtn'); // ØªÙ… Ø¬Ù„Ø¨ Ø²Ø± Ø§Ù„Ø¨ÙŠØ¹

        // NEW: Price Control Variables for Hold-down
        let priceAdjustInterval = null;

        function playSound(audioElement) {
            if(!audioElement) return;
            try{
                audioElement.currentTime = 0;
                audioElement.play().catch(e => {/*ignore autoplay issues*/});
            }catch(e){}
        }

        function flash(id){
            const el = document.getElementById(id);
            if(!el) return;
            el.classList.add('glow-update');
            setTimeout(()=>el.classList.remove('glow-update'),900);
        }
        
        // **ÙˆØ¸ÙŠÙØ© Ø¬Ø¯ÙŠØ¯Ø©: Ø¥Ù†Ø´Ø§Ø¡ ÙˆØªØ·Ø§ÙŠØ± Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ**
        function createFloatingEmoji(buttonElement, emoji, count = 5) {
            const rect = buttonElement.getBoundingClientRect();
            for (let i = 0; i < count; i++) {
                const particle = document.createElement('span');
                particle.textContent = emoji;
                particle.classList.add('floating-emoji');
                
                // ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆØ¶Ø¹ Ø§Ù„Ø¨Ø¯Ø¡ Ø¨Ø´ÙƒÙ„ Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø¯Ø§Ø®Ù„ Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø²Ø±
                const x = rect.left + rect.width / 2 + (Math.random() - 0.5) * rect.width * 0.4;
                const y = rect.top + rect.height / 2 + (Math.random() - 0.5) * rect.height * 0.4;
                
                particle.style.left = `${x}px`;
                particle.style.top = `${y}px`;
                
                document.body.appendChild(particle);

                // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø­Ø±ÙƒØ©
                setTimeout(() => {
                    particle.remove();
                }, 1200); 
            }
        }
        
        // NEW: Game Over Check
        function checkGameOver() {
            // Ø´Ø±Ø· Ø§Ù„Ø®Ø³Ø§Ø±Ø©: Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ù„Ùƒ AND Ø§Ù„Ù…Ø§Ù„ < ØªÙƒÙ„ÙØ© Ø§Ù„Ø³Ù„Ùƒ AND Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø´Ø§Ø¨Ùƒ Ù„Ø¨ÙŠØ¹Ù‡Ø§
            if (gameState.wire === 0 && gameState.money < gameState.wireCost && gameState.clips === 0) {
                
                finalMoneyEl.textContent = gameState.money.toFixed(2);
                finalSoldEl.textContent = gameState.totalSold.toLocaleString();
                
                gameOverModal.classList.add('active');
                playSound(failSound); // ØªØ´ØºÙŠÙ„ ØµÙˆØª Ø§Ù„Ø®Ø³Ø§Ø±Ø©
                
                // Ø¥ÙŠÙ‚Ø§Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ù„Ù…Ù†Ø¹ Ø£ÙŠ ØªÙØ§Ø¹Ù„ Ø¢Ø®Ø± Ø¹Ø¯Ø§ "Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨"
                document.querySelectorAll('button').forEach(btn => btn.disabled = true);
                document.getElementById('autoSellBtn').disabled = true;
                document.querySelector('.guide-btn').style.display = 'none';
                document.querySelector('#gameOverModal button').disabled = false;

                console.log("Game Over: Stuck without clips or wire!");
                return true;
            }
            return false;
        }

        function checkTrophy(newTotalSold) {
            const body = document.body;

            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙƒØ¤ÙˆØ³ Ø£ÙˆÙ„Ø§Ù‹
            trophyBronzeIcon.style.display = 'none';
            trophySilverIcon.style.display = 'none';
            trophyGoldIcon.style.display = 'none';

            // Ø¥Ø²Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¬Ø³Ù… Ø£ÙˆÙ„Ø§Ù‹
            body.classList.remove('trophy-bronze', 'trophy-silver', 'trophy-gold');


            // Ø¥Ù†Ø¬Ø§Ø² Ø¨Ø±ÙˆÙ†Ø²ÙŠ (1000 Ù…Ø¨ÙŠØ¹Ø©)
            if (!gameState.trophyBronze && newTotalSold >= 1000) {
                gameState.trophyBronze = true;
                body.classList.add('trophy-bronze');
                trophyBronzeIcon.style.display = 'flex';
                playSound(trophySound);
                console.log("Trophy Unlocked: Bronze (1,000 Clips Sold)");
            }
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ø¨Ø±ÙˆÙ†Ø²ÙŠ Ù…Ø­Ù‚Ù‚Ù‹Ø§ Ø¨Ø§Ù„ÙØ¹Ù„ ÙˆÙ„Ù… ÙŠØªÙ… ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„ÙØ¶ÙŠ Ø£Ùˆ Ø§Ù„Ø°Ù‡Ø¨ÙŠ Ø¨Ø¹Ø¯
            else if (gameState.trophyBronze && newTotalSold < 10000) {
                body.classList.add('trophy-bronze');
                trophyBronzeIcon.style.display = 'flex';
            }


            // Ø¥Ù†Ø¬Ø§Ø² ÙØ¶ÙŠ (10000 Ù…Ø¨ÙŠØ¹Ø©)
            if (!gameState.trophySilver && newTotalSold >= 10000) {
                gameState.trophySilver = true;
                body.classList.add('trophy-silver');
                trophySilverIcon.style.display = 'flex';
                playSound(trophySound);
                console.log("Trophy Unlocked: Silver (10,000 Clips Sold)");
            }
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„ÙØ¶ÙŠ Ù…Ø­Ù‚Ù‚Ù‹Ø§ Ø¨Ø§Ù„ÙØ¹Ù„ ÙˆÙ„Ù… ÙŠØªÙ… ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ø°Ù‡Ø¨ÙŠ Ø¨Ø¹Ø¯
            else if (gameState.trophySilver && newTotalSold < 100000) {
                body.classList.add('trophy-silver');
                trophySilverIcon.style.display = 'flex';
            }


            // Ø¥Ù†Ø¬Ø§Ø² Ø°Ù‡Ø¨ÙŠ (100000 Ù…Ø¨ÙŠØ¹Ø©)
            if (!gameState.trophyGold && newTotalSold >= 100000) {
                gameState.trophyGold = true;
                body.classList.add('trophy-gold');
                trophyGoldIcon.style.display = 'flex';
                playSound(trophySound);
                console.log("Trophy Unlocked: Gold (100,000 Clips Sold)");
            }
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ø°Ù‡Ø¨ÙŠ Ù…Ø­Ù‚Ù‚Ù‹Ø§ Ø¨Ø§Ù„ÙØ¹Ù„
            else if (gameState.trophyGold) {
                body.classList.add('trophy-gold');
                trophyGoldIcon.style.display = 'flex';
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ù…Ø¤Ù‚Øª Ø§Ù„ØªØ£Ù…ÙŠÙ†
        function updateInsuranceTimer() {
            const remainingTime = gameState.insuranceEndTime - Date.now();
            const insuranceBtn = document.getElementById('insuranceBtn');
            const insuranceCostSpan = document.getElementById('insuranceCost');

            if (remainingTime > 0) {
                const minutes = Math.floor(remainingTime / 60000);
                const seconds = Math.floor((remainingTime % 60000) / 1000);
                insuranceTimerEl.textContent = `Ø§Ù„ØªØ£Ù…ÙŠÙ† Ù†Ø´Ø·: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                insuranceTimerEl.style.display = 'block';
                // Ø£Ø«Ù†Ø§Ø¡ Ù†Ø´Ø§Ø· Ø§Ù„ØªØ£Ù…ÙŠÙ†ØŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø´Ø±Ø§Ø¡ ÙˆÙ„ÙƒÙ†Ù‡ Ù„Ø§ ÙŠØ²Ø§Ù„ ÙŠØ¸Ù‡Ø± Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„ØªØ§Ù„ÙŠØ©
                insuranceBtn.disabled = true;
            } else {
                gameState.insuranceEndTime = 0; // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„ÙˆÙ‚Øª ÙŠÙ†ØªÙ‡ÙŠ
                insuranceTimerEl.textContent = '';
                insuranceTimerEl.style.display = 'none';
                insuranceBtn.disabled = gameState.money < gameState.insuranceCost; // Ø£Ø¹Ø¯ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø²Ø± Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ø¯ÙŠÙ‡ Ù…Ø§Ù„
            }
            
            insuranceCostSpan.textContent = gameState.insuranceCost.toFixed(2);
        }
        
        // Ù…Ø¤Ù‚Øª ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ£Ù…ÙŠÙ†
        setInterval(updateInsuranceTimer, 1000);


        function updateUI(){
            document.getElementById('clips').textContent = gameState.clips.toLocaleString();
            document.getElementById('money').textContent = gameState.money.toFixed(2);
            document.getElementById('wire').textContent = gameState.wire.toLocaleString();
            document.getElementById('demand').textContent = gameState.demand;
            document.getElementById('price').textContent = gameState.price.toFixed(2);
            document.getElementById('autoClippers').textContent = gameState.autoClippers;
            // ØªÙ… Ø­Ø°Ù ØªØ­Ø¯ÙŠØ« 'autoRate' Ù…Ù† Ù‡Ù†Ø§ Ø£ÙŠØ¶Ø§Ù‹ Ù„Ø£Ù†Ù‡ ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ù†ØµØ± Ù…Ù† HTML
            // document.getElementById('autoRate').textContent = gameState.autoClipperRate; 
            document.getElementById('autoClipperCost').textContent = gameState.autoClipperCost.toFixed(2);
            document.getElementById('wireCost').textContent = gameState.wireCost.toFixed(2);
            document.getElementById('wireEfficiency').textContent = gameState.wireEfficiency.toFixed(1);
            document.getElementById('efficiencyCost').textContent = (gameState.wireEfficiency * 1000).toFixed(2);
            document.getElementById('marketingLevel').textContent = gameState.marketingLevel;
            document.getElementById('marketingCost').textContent = (gameState.marketingLevel * 100).toFixed(2);
            document.getElementById('availableClips').textContent = gameState.clips;
            document.getElementById('totalClips').textContent = gameState.totalClips.toLocaleString();
            document.getElementById('totalSold').textContent = gameState.totalSold.toLocaleString();
            document.getElementById('totalMachines').textContent = gameState.autoClippers;
            document.getElementById('productionRate').textContent = gameState.autoClipperRate;
            
            // ØªØ­Ø¯ÙŠØ« Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ£Ù…ÙŠÙ† Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
            document.getElementById('insuranceLevel').textContent = gameState.insuranceLevel;
            document.getElementById('insuranceCost').textContent = gameState.insuranceCost.toFixed(2);
            
            // NEW: ØªØ­Ø¯ÙŠØ« Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªÙˆØ³Ø¹Ø©
            document.getElementById('maxClippers').textContent = gameState.maxClippersLimit.toLocaleString();
            document.getElementById('expansionCost').textContent = gameState.expansionCost.toFixed(2);
            
            // NEW: ØªØ­Ø¯ÙŠØ« Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹
            document.getElementById('clipsLimit').textContent = gameState.maxClipsLimit.toLocaleString();
            document.getElementById('clipsLimitCurrent').textContent = gameState.maxClipsLimit.toLocaleString();
            document.getElementById('warehouseCost').textContent = gameState.warehouseCost.toFixed(2);
            
            updateInsuranceTimer(); // ØªØ­Ø¯ÙŠØ« Ø®Ø§Øµ Ø¨Ø­Ø§Ù„Ø© Ø§Ù„ØªØ£Ù…ÙŠÙ† ÙˆØ§Ù„Ø²Ø±
            
            // const makeBtn = document.getElementById('makeBtn'); // ØªÙ… Ù†Ù‚Ù„Ù‡Ø§ Ø¥Ù„Ù‰ Ù†Ø·Ø§Ù‚ Ø£ÙˆØ³Ø¹
            // NEW: ÙŠØ¬Ø¨ Ø£Ù† ÙŠØªØ¹Ø·Ù„ Ø²Ø± Ø§Ù„ØµÙ†Ø¹ Ø¥Ø°Ø§ Ù†ÙØ¯ Ø§Ù„Ø³Ù„Ùƒ Ø£Ùˆ Ø¥Ø°Ø§ Ø§Ù…ØªÙ„Ø£ Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹
            makeBtn.disabled = gameState.wire < 1 || gameState.clips >= gameState.maxClipsLimit;
            document.getElementById('makeBtnText').textContent = gameState.wire < 1 ? 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ù„Ùƒ' : 
                                                               gameState.clips >= gameState.maxClipsLimit ? 'Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ù…Ù…ØªÙ„Ø¦' : 'ØµÙ†Ø¹ Ù…Ø´Ø¨Ùƒ';

            // const sellBtn = document.getElementById('sellBtn'); // ØªÙ… Ù†Ù‚Ù„Ù‡Ø§ Ø¥Ù„Ù‰ Ù†Ø·Ø§Ù‚ Ø£ÙˆØ³Ø¹
            sellBtn.disabled = gameState.clips === 0;
            // NEW: Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ø¢Ù„Ø§Øª
            document.getElementById('autoClipperBtn').disabled = gameState.money < gameState.autoClipperCost || gameState.autoClippers >= gameState.maxClippersLimit;
            document.getElementById('wireBtn').disabled = gameState.money < gameState.wireCost;
            document.getElementById('efficiencyBtn').disabled = gameState.money < gameState.wireEfficiency * 1000;
            document.getElementById('marketingBtn').disabled = gameState.money < gameState.marketingLevel * 100;
            document.getElementById('expansionBtn').disabled = gameState.money < gameState.expansionCost; // NEW: Ø²Ø± Ø§Ù„ØªÙˆØ³Ø¹Ø©
            document.getElementById('warehouseBtn').disabled = gameState.money < gameState.warehouseCost; // NEW: Ø²Ø± Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹
            
            // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø£ÙØ¶Ù„ Ù†ØªÙŠØ¬Ø© Ù…Ø­Ù„ÙŠØ©
            bestTotalSoldEl.textContent = bestLocalScore.totalSold.toLocaleString();
            bestMoneyEl.textContent = parseFloat(bestLocalScore.money || 0).toFixed(2);
            bestDateEl.textContent = bestLocalScore.date ? new Date(bestLocalScore.date).toLocaleString() : 'â€”';
            
            checkGameOver(); // NEW: ÙØ­Øµ Ø§Ù„Ø®Ø³Ø§Ø±Ø©
        }

        function makeClip(){
            // NEW: ÙØ­Øµ Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ù…Ø´Ø§Ø¨Ùƒ
            if(gameState.wire >= 1 && gameState.clips < gameState.maxClipsLimit){
                gameState.clips++;
                gameState.totalClips++;
                gameState.wire--;
                
                // **Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± ØªØ·Ø§ÙŠØ± Ø§Ù„Ù…Ø´Ø§Ø¨Ùƒ**
                createFloatingEmoji(makeBtn, 'ğŸ“', 5);

                playSound(clickSound); // ØµÙˆØª ØµÙ†Ø¹ Ù…Ø´Ø¨Ùƒ
                flash('card-clips');
                flash('card-wire');
                updateUI();
            }
        }

        function sellClips(){
            if(gameState.clips > 0){
                const sellAmount = Math.min(gameState.clips, gameState.demand);
                gameState.clips -= sellAmount;
                const revenue = sellAmount * gameState.price;
                gameState.money += revenue;
                gameState.totalSold += sellAmount;
                gameState.demand = Math.max(10, gameState.demand - Math.floor(sellAmount * 0.1));
                
                if (sellAmount > 0) {
                    // **Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± ØªØ·Ø§ÙŠØ± Ø§Ù„Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©**
                    createFloatingEmoji(sellBtn, 'ğŸ’µ', Math.min(sellAmount, 8)); // ÙŠØªØ·Ø§ÙŠØ± 8 ÙƒØ­Ø¯ Ø£Ù‚ØµÙ‰

                    playSound(cashSound); // ØµÙˆØª Ø¨ÙŠØ¹ Ø§Ù„Ù…Ø´Ø§Ø¨Ùƒ
                    checkTrophy(gameState.totalSold);
                    checkLocalRecord(); // NEW: ÙØ­Øµ ÙˆØªØ­Ø¯ÙŠØ« Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠØ©
                }
                
                flash('card-money');
                flash('card-clips');
                updateUI();
            }
        }

        function buyWire(){
            if(gameState.money >= gameState.wireCost){
                gameState.money -= gameState.wireCost;
                gameState.wire += 1000 * gameState.wireEfficiency;
                playSound(buySound); // ØµÙˆØª Ø´Ø±Ø§Ø¡ Ø³Ù„Ùƒ
                flash('card-wire');
                flash('card-money');
                updateUI();
            }
        }

        function buyAutoClipper(){
            // NEW: Ø¥Ø¶Ø§ÙØ© Ø´Ø±Ø· Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ø¢Ù„Ø§Øª
            if(gameState.money >= gameState.autoClipperCost && gameState.autoClippers < gameState.maxClippersLimit){
                gameState.money -= gameState.autoClipperCost;
                gameState.autoClippers++;
                // ÙŠØªÙ… Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ØªÙƒÙ„ÙØ© Ø¨Ø´ÙƒÙ„ Ø·Ø¨ÙŠØ¹ÙŠ Ø¥Ø°Ø§ Ù„Ù… Ù†ØµÙ„ Ù„Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ
                if (gameState.autoClippers % 100 !== 0) {
                    gameState.autoClipperCost = Math.floor(gameState.autoClipperCost * 1.15);
                } else {
                    // Ø¥Ø°Ø§ ÙˆØµÙ„Ù†Ø§ Ù„Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ØŒ ØªØ«Ø¨ÙŠØª Ø§Ù„ØªÙƒÙ„ÙØ© Ù…Ø¤Ù‚ØªØ§Ù‹
                    // Ø¹Ù†Ø¯ Ø§Ù„ØªÙˆØ³Ø¹Ø©ØŒ Ø³ÙŠØ¹Ø§Ø¯ ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªÙƒÙ„ÙØ© ÙˆÙÙ‚Ø§Ù‹ Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ù„Ø¹Ø¨Ø©
                }
                
                playSound(buySound); // ØµÙˆØª Ø´Ø±Ø§Ø¡ Ø¢Ù„Ø©
                flash('card-clips');
                flash('card-money');
                updateUI();
            }
        }

        function adjustPrice(delta){
            gameState.price = Math.max(0.01, Math.round((gameState.price + delta)*100)/100);
            if(delta > 0) gameState.demand = Math.max(5, gameState.demand - 5);
            else gameState.demand = Math.min(100 * gameState.marketingLevel, gameState.demand + 5); // Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰
            flash('card-demand');
            updateUI();
        }
        
        // NEW: Price Adjust with Hold-down logic
        function startPriceAdjust(delta) {
            adjustPrice(delta); // Run once immediately
            // Clear any existing interval to prevent overlapping
            if (priceAdjustInterval) clearInterval(priceAdjustInterval);
            // Set a new interval for continuous adjustment
            priceAdjustInterval = setInterval(() => {
                adjustPrice(delta);
            }, 180); // ØªÙ… ØªØ®ÙÙŠÙ Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ© Ø¥Ù„Ù‰ 180ms
        }

        function stopPriceAdjust() {
            if (priceAdjustInterval) {
                clearInterval(priceAdjustInterval);
                priceAdjustInterval = null;
            }
        }

        function increaseMarketing(){
            const cost = gameState.marketingLevel * 100;
            if(gameState.money >= cost){
                gameState.money -= cost;
                gameState.marketingLevel++;
                gameState.demand = Math.min(100 * gameState.marketingLevel, gameState.demand + 20); // Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¬Ø¯ÙŠØ¯
                playSound(buySound); 
                flash('card-demand');
                flash('card-money');
                updateUI();
            }
        }

        // NEW: Ø¯Ø§Ù„Ø© ØªØ±Ù‚ÙŠØ© Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹
        function upgradeWarehouse(){
            const cost = gameState.warehouseCost;
            if(gameState.money >= cost){
                gameState.money -= cost;
                gameState.maxClipsLimit += 5000; // Ø¥Ø¶Ø§ÙØ© 5000 Ù…Ø´Ø¨Ùƒ Ù„Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰
                gameState.warehouseCost = Math.floor(gameState.warehouseCost * 1.5); // Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ØªÙƒÙ„ÙØ© Ø¨Ù†Ø³Ø¨Ø© 50%
                
                playSound(buySound); 
                flash('card-clips');
                flash('card-money');
                updateUI();
            }
        }

        function buyWireEfficiency(){
            const cost = gameState.wireEfficiency * 1000;
            if(gameState.money >= cost){
                gameState.money -= cost;
                gameState.wireEfficiency += 0.5;
                playSound(buySound); 
                flash('card-wire');
                flash('card-money');
                updateUI();
            }
        }
        
        // NEW: ÙˆØ¸ÙŠÙØ© ØªÙˆØ³Ø¹Ø© Ø§Ù„Ù…ØµÙ†Ø¹
        function buyExpansion(){
            const cost = gameState.expansionCost;
            if(gameState.money >= cost){
                gameState.money -= cost;
                gameState.maxClippersLimit += 100; // Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ø¨Ù…Ù‚Ø¯Ø§Ø± 100
                gameState.expansionCost = Math.floor(gameState.expansionCost * 2); // Ù…Ø¶Ø§Ø¹ÙØ© ØªÙƒÙ„ÙØ© Ø§Ù„ØªÙˆØ³Ø¹Ø©
                
                playSound(buySound); 
                flash('card-money');
                updateUI();
            }
        }
        
        // ÙˆØ¸ÙŠÙØ© Ø´Ø±Ø§Ø¡ Ø§Ù„ØªØ£Ù…ÙŠÙ† Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
        function buyInsurance(){
            const cost = gameState.insuranceCost;
            if(gameState.money >= cost){
                gameState.money -= cost;
                gameState.insuranceLevel++;
                gameState.insuranceCost = gameState.insuranceLevel * 1000;
                
                // Ø¥Ø¶Ø§ÙØ© 5 Ø¯Ù‚Ø§Ø¦Ù‚ (300,000 Ù…Ù„Ù„ÙŠ Ø«Ø§Ù†ÙŠØ©)
                const now = Date.now();
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØªØ£Ù…ÙŠÙ† Ù†Ø´Ø·Ø§Ù‹ØŒ ÙŠØªÙ… ØªÙ…Ø¯ÙŠØ¯ Ø§Ù„ÙˆÙ‚Øª. Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù†Ø´Ø·Ø§Ù‹ØŒ ÙŠØ¨Ø¯Ø£ Ø§Ù„Ø¢Ù†.
                gameState.insuranceEndTime = Math.max(gameState.insuranceEndTime, now) + 300000; 
                
                playSound(buySound); 
                flash('card-money');
                updateUI();
            }
        }

        function toggleAutoSell(){
            gameState.autoSellEnabled = !gameState.autoSellEnabled;
            const btn = document.getElementById('autoSellBtn');
            btn.className = gameState.autoSellEnabled ? 'toggle-btn toggle-on' : 'toggle-btn toggle-off';
        }

        function toggleGuide(){
            const modal = document.getElementById('guideModal');
            modal.classList.toggle('active');
        }
        
        function closeChallengeModal(){
             challengeModal.classList.remove('active');
             updateUI();
        }
        
        // Ù…Ù†Ø·Ù‚ Ø§Ù„Ø­ÙˆØ§Ø¯Ø« Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
        function triggerRandomChallenge() {
            // ØªØ­Ù‚Ù‚ Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØªØ£Ù…ÙŠÙ† Ù†Ø´Ø·Ù‹Ø§
            if (gameState.insuranceEndTime > Date.now()) {
                console.log("Challenge blocked by insurance!");
                return; 
            }
            
            // ÙØ±ØµØ© 10% Ù„ÙˆÙ‚ÙˆØ¹ Ø­Ø§Ø¯Ø« Ø¹Ø´ÙˆØ§Ø¦ÙŠ
            if (Math.random() < 0.10) { 
                
                let isMoneyLoss = false;
                let isClipsLoss = false;
                let isClipperLoss = false; // NEW
                let isDemandLoss = false; // NEW
                let challengeType = null;

                // ØªØ­Ø¯ÙŠ 1: Ø³Ø±Ù‚Ø© Ø§Ù„Ù…Ø§Ù„ (Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø§Ù„ > 4500)
                if (gameState.money >= 4500 && Math.random() < 0.25) { 
                    challengeType = 'money';
                } 
                
                // ØªØ­Ø¯ÙŠ 2: Ø­Ø±ÙŠÙ‚ Ø§Ù„Ù…Ø´Ø§Ø¨Ùƒ (Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù…Ø´Ø§Ø¨Ùƒ > 7500)
                else if (gameState.clips >= 7500 && Math.random() < 0.25) {
                    challengeType = 'clips';
                }
                
                // ØªØ­Ø¯ÙŠ 3: ØªÙ„Ù Ø§Ù„Ø¢Ù„Ø§Øª (Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ø¯ÙŠÙƒ 100 Ø¢Ù„Ø© Ø£Ùˆ Ø£ÙƒØ«Ø±) - NEW REQUIREMENT 1
                else if (gameState.autoClippers >= 100 && Math.random() < 0.25) {
                    challengeType = 'clippers';
                }
                
                // ØªØ­Ø¯ÙŠ 4: Ø¯Ø¹Ø§ÙŠØ© Ø³Ù„Ø¨ÙŠØ© (Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø·Ù„Ø¨ 100 Ø£Ùˆ Ø£ÙƒØ«Ø±) - NEW REQUIREMENT 2
                else if (gameState.demand >= 100 && Math.random() < 0.25) {
                    challengeType = 'demand';
                }
                
                // Ø¥Ø°Ø§ Ù„Ù… ÙŠØªØ­Ù‚Ù‚ Ø£ÙŠ Ø´Ø±Ø·ØŒ Ù„Ø§ ÙŠØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ­Ø¯ÙŠ
                if (!challengeType) return;


                if (challengeType === 'money') {
                    const lossAmount = 500;
                    gameState.money = Math.max(0, gameState.money - lossAmount);
                    
                    challengeTitle.textContent = "âš ï¸ Ø­Ø§Ø¯Ø«: Ø³Ø±Ù‚Ø©!";
                    challengeMessage.innerHTML = `Ø­Ø¯Ø«Øª Ø³Ø±Ù‚Ø© ÙÙŠ Ø§Ù„Ù…ØµÙ†Ø¹! Ø³ÙØ±Ù‚ <strong>$${lossAmount.toFixed(2)}</strong> Ù…Ù† Ø£Ù…ÙˆØ§Ù„Ùƒ.`;                    
                    playSound(warningSound); // ØªØ´ØºÙŠÙ„ Ù†ØºÙ…Ø© Ø§Ù„ØªØ­Ø°ÙŠØ±
                    flash('card-money');

                } else if (challengeType === 'clips') {
                    const lossAmount = 500;
                    gameState.clips = Math.max(0, gameState.clips - lossAmount);
                    
                    challengeTitle.textContent = "ğŸ”¥ Ø­Ø§Ø¯Ø«: Ø­Ø±ÙŠÙ‚!";
                    challengeMessage.innerHTML = `Ø§Ù†Ø¯Ù„Ø¹ Ø­Ø±ÙŠÙ‚ ÙÙŠ Ø§Ù„Ù…Ø®Ø²Ù†! ØªÙ„Ù <strong>${lossAmount.toLocaleString()}</strong> Ù…Ø´Ø¨Ùƒ ÙˆØ±Ù‚ÙŠ.`;
                    
                    playSound(fireSound); // ØªØ´ØºÙŠÙ„ Ù†ØºÙ…Ø© Ø§Ù„Ø­Ø±ÙŠÙ‚
                    flash('card-clips');

                } else if (challengeType === 'clippers') { // NEW: Clipper Loss Challenge
                    const lossAmount = 20;
                    gameState.autoClippers = Math.max(0, gameState.autoClippers - lossAmount);
                    
                    challengeTitle.textContent = "âš™ï¸ Ø­Ø§Ø¯Ø«: ØªÙ„Ù Ø¢Ù„Ø§Øª!";
                    challengeMessage.innerHTML = `Ø­Ø¯Ø« Ø¹Ø·Ù„ ÙÙ†ÙŠ ÙƒØ¨ÙŠØ±! ØªØ¹Ø·Ù„Øª <strong>${lossAmount}</strong> Ø¢Ù„Ø© ØµÙ†Ø¹ ØªÙ„Ù‚Ø§Ø¦ÙŠ.`;
                    
                    playSound(fireSound); // Ø§Ø³ØªØ®Ø¯Ø§Ù… ØµÙˆØª Ø§Ù„Ø­Ø±ÙŠÙ‚/Ø®Ø³Ø§Ø±Ø© (ÙŠÙ…ÙƒÙ† ØªØºÙŠÙŠØ± Ø§Ù„ØµÙˆØª)
                    flash('autoClippers');

                } else if (challengeType === 'demand') { // NEW: Negative Publicity Challenge
                    const oldDemand = gameState.demand;
                    gameState.demand = 1; // ØªØ®ÙÙŠØ¶ Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ 1
                    
                    challengeTitle.textContent = "ğŸ“‰ ØªØ­Ø¯ÙŠ: Ø¯Ø¹Ø§ÙŠØ© Ø³Ù„Ø¨ÙŠØ©!";
                    challengeMessage.innerHTML = `Ø§Ù†ØªØ´Ø±Øª Ø¥Ø´Ø§Ø¹Ø§Øª Ø³Ù„Ø¨ÙŠØ© Ø¹Ù† Ù…Ù†ØªØ¬Ø§ØªÙƒ! Ø§Ù†Ø®ÙØ¶ Ø§Ù„Ø·Ù„Ø¨ Ù…Ù† <strong>${oldDemand}</strong> Ø¥Ù„Ù‰ <strong>${gameState.demand}</strong>.`;
                    
                    playSound(warningSound); // Ø§Ø³ØªØ®Ø¯Ø§Ù… ØµÙˆØª Ø§Ù„ØªØ­Ø°ÙŠØ±
                    flash('card-demand');
                }
                
                challengeModal.classList.add('active');
                updateUI();
            }
        }

        // Auto production
        setInterval(()=>{
            // NEW: Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù„Ø¹Ø¨Ø© Ù‚Ø¯ Ø§Ù†ØªÙ‡ØªØŒ Ù„Ø§ ØªÙƒÙ…Ù„ Ø§Ù„Ø¥Ù†ØªØ§Ø¬
            if (checkGameOver()) return;
            
            if(gameState.autoClippers > 0 && gameState.wire >= gameState.autoClippers){
                
                // NEW: Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø´Ø§Ø¨Ùƒ Ø§Ù„ØªÙŠ Ø³ÙŠØªÙ… ØµÙ†Ø¹Ù‡Ø§ Ù…Ø¹ Ø§Ù„Ø£Ø®Ø° ÙÙŠ Ø§Ù„Ø§Ø¹ØªØ¨Ø§Ø± Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ù…Ø³ØªÙˆØ¯Ø¹
                let potentialClips = gameState.autoClippers;
                let availableSpace = gameState.maxClipsLimit - gameState.clips;
                let clipsMade = Math.min(potentialClips, availableSpace);

                if (clipsMade > 0) {
                    gameState.clips += clipsMade;
                    gameState.totalClips += clipsMade;
                    gameState.wire -= clipsMade;
                    gameState.autoClipperRate = gameState.autoClippers;
                    flash('card-clips');
                    flash('card-wire');
                    updateUI();
                } else if (gameState.clips >= gameState.maxClipsLimit) {
                    gameState.autoClipperRate = 0; // Ù…Ø¹Ø¯Ù„ Ø¥Ù†ØªØ§Ø¬ ØµÙØ± Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ù…ØªÙ„Ø¦Ø§Ù‹
                    updateUI();
                }
            }
        },1000);

        // Auto sell
        setInterval(()=>{
            // NEW: Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù„Ø¹Ø¨Ø© Ù‚Ø¯ Ø§Ù†ØªÙ‡ØªØŒ Ù„Ø§ ØªÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ¹
            if (checkGameOver()) return;
            
            if(gameState.autoSellEnabled && gameState.clips > 0){
                const sellAmount = Math.min(gameState.clips, Math.max(1, Math.floor(gameState.demand * 0.1)), 10);
                gameState.clips -= sellAmount;
                gameState.money += sellAmount * gameState.price;
                gameState.totalSold += sellAmount;
                
                if (sellAmount > 0) {
                    // Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ø¨ÙŠØ¹ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ø§ ÙŠØ¶ÙŠÙ ØªØ£Ø«ÙŠØ± Ø§Ù„ØªØ·Ø§ÙŠØ± Ù„Ø£Ù†Ù‡ ÙŠØ­Ø¯Ø« ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©
                    playSound(cashSound); // ØµÙˆØª Ø¨ÙŠØ¹ Ø§Ù„Ù…Ø´Ø§Ø¨Ùƒ Ù„Ù„Ø¨ÙŠØ¹ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
                    checkTrophy(gameState.totalSold);
                    checkLocalRecord(); // NEW: ÙØ­Øµ ÙˆØªØ­Ø¯ÙŠØ« Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠØ©
                }

                flash('card-money');
                flash('card-clips');
                updateUI();
            }
        },2000);

        // Restore demand and check random challenges
        setInterval(()=>{
            // NEW: Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù„Ø¹Ø¨Ø© Ù‚Ø¯ Ø§Ù†ØªÙ‡ØªØŒ Ù„Ø§ ØªÙƒÙ…Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª
            if (checkGameOver()) return;
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨
            gameState.demand = Math.min(100 * gameState.marketingLevel, gameState.demand + gameState.marketingLevel);
            
            // ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­ÙˆØ§Ø¯Ø« Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© ÙƒÙ„ 3 Ø«ÙˆØ§Ù† (Ø¨Ø§Ù„ØªØ²Ø§Ù…Ù† Ù…Ø¹ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨)
            triggerRandomChallenge();
            
            updateUI();
        },3000);

        // ========== Local Leaderboard: load / save / notify ==========
        const STORAGE_KEY = 'bestLocalScore';

        function loadBestScore() {
            try {
                const raw = localStorage.getItem(STORAGE_KEY);
                if (raw) {
                    const parsed = JSON.parse(raw);
                    if (parsed && typeof parsed.totalSold !== 'undefined') {
                        bestLocalScore.totalSold = parsed.totalSold || 0;
                        bestLocalScore.money = parsed.money || 0;
                        bestLocalScore.date = parsed.date || null;
                    }
                }
            } catch(e){
                console.error("Error loading bestLocalScore:", e);
            }
        }

        function saveBestScore() {
            try {
                const payload = {
                    totalSold: bestLocalScore.totalSold,
                    money: bestLocalScore.money,
                    date: bestLocalScore.date
                };
                localStorage.setItem(STORAGE_KEY, JSON.stringify(payload));
            } catch(e){
                console.error("Error saving bestLocalScore:", e);
            }
        }

       function checkLocalRecord() {
           const previousBest = bestLocalScore.totalSold || 0;

            if (gameState.totalSold > previousBest + 1000) {
                bestLocalScore.totalSold = gameState.totalSold;
                bestLocalScore.money = parseFloat(gameState.money.toFixed(2));
                bestLocalScore.date = new Date().toISOString();
                saveBestScore();

                showRecordNotification();
                playSound(completionSound);
                flash('card-clips');
                flash('card-money');
                console.log("New local record saved:", bestLocalScore);
                updateUI();
            }
        }

        let recordTimeouts = [];
        function showRecordNotification() {
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±ØŒ Ø«Ù… ØªÙ„Ø§Ø´ÙŠÙ‡ ØªØ¯Ø±ÙŠØ¬ÙŠÙ‹Ø§ Ø¨Ø¹Ø¯ 4 Ø«ÙˆØ§Ù†Ù
            try {
                // Ø¥ÙŠÙ‚Ø§Ù Ø£ÙŠ Ù…Ø¤Ù‚ØªØ§Øª Ø³Ø§Ø¨Ù‚Ø© Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø·
                recordTimeouts.forEach(t => clearTimeout(t));
                recordTimeouts = [];

                recordNotificationEl.classList.remove('fade-out');
                // Force reflow for reliable animation restart
                void recordNotificationEl.offsetWidth;
                recordNotificationEl.classList.add('show');

                // Ø¨Ø¹Ø¯ 4 Ø«ÙˆØ§Ù†Ù Ù†Ø¶ÙŠÙ ÙØ¦Ø© fade-out Ù„Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ„Ø§Ø´ÙŠ
                const t1 = setTimeout(()=>{
                    recordNotificationEl.classList.add('fade-out');
                    recordNotificationEl.classList.remove('show');
                }, 2000);

                // Ø¨Ø¹Ø¯ Ù…Ø¯Ø© Ø¥Ø¶Ø§ÙÙŠØ© Ù†Ø²ÙŠÙ„ ÙƒÙ„ Ø§Ù„ÙØ¦Ø§Øª Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
                const t2 = setTimeout(()=>{
                    recordNotificationEl.classList.remove('fade-out');
                    recordNotificationEl.classList.remove('show');
                }, 4800);

                recordTimeouts.push(t1, t2);
            } catch(e){ console.error(e); }
        }

        function resetBestScore() {
            bestLocalScore = { totalSold: 0, money: 0, date: null };
            try {
                localStorage.removeItem(STORAGE_KEY);
            } catch(e){ console.error(e); }
            updateUI();
            // feedback ØµØºÙŠØ±
            recordNotificationEl.querySelector('span:nth-child(2)').textContent = 'ØªÙ…Øª Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…Ø­Ù„ÙŠØ©.';
            playSound(completionSound);
            showRecordNotification();
            // Ø§Ø³ØªØ±Ø¬Ø¹ Ø§Ù„Ù†Øµ Ø§Ù„Ø£ØµÙ„ÙŠ Ø¨Ø¹Ø¯ 1.5 Ø«Ø§Ù†ÙŠØ©
            setTimeout(()=>{
                recordNotificationEl.querySelector('span:nth-child(2)').textContent = 'ğŸ‰ Ø±Ù‚Ù… Ù‚ÙŠØ§Ø³ÙŠ Ø¬Ø¯ÙŠØ¯! ØªÙ… ØªØ­Ø·ÙŠÙ… Ø£ÙØ¶Ù„ Ù…Ø¨ÙŠØ¹Ø§ØªÙƒ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©!';
            }, 1400);
        }

        // ØªØµØ¯ÙŠØ± Ø³Ø±ÙŠØ¹ Ù„Ù„Ù†ØªÙŠØ¬Ø© (Ù†Ø³Ø® Ù„Ù„Ù†Øµ)
        function exportBestScore() {
            const text = `Ø£ÙØ¶Ù„ Ù…Ø¨ÙŠØ¹Ø§Øª Ù…Ø­Ù„ÙŠØ©: ${bestLocalScore.totalSold.toLocaleString()} Ù…Ø´Ø¨Ùƒ â€” Ø§Ù„Ù…Ø§Ù„: $${parseFloat(bestLocalScore.money || 0).toFixed(2)} â€” Ø§Ù„ØªØ§Ø±ÙŠØ®: ${bestLocalScore.date ? new Date(bestLocalScore.date).toLocaleString() : 'â€”'}`;
            try {
                navigator.clipboard.writeText(text).then(()=> {
                    recordNotificationEl.querySelector('span:nth-child(2)').textContent = 'ØªÙ… Ù†Ø³Ø® Ø£ÙØ¶Ù„ Ù†ØªÙŠØ¬Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©!';
                    playSound(completionSound);
                    showRecordNotification();
                    setTimeout(()=>{
                        recordNotificationEl.querySelector('span:nth-child(2)').textContent = 'ğŸ‰ Ø±Ù‚Ù… Ù‚ÙŠØ§Ø³ÙŠ Ø¬Ø¯ÙŠØ¯! ØªÙ… ØªØ­Ø·ÙŠÙ… Ø£ÙØ¶Ù„ Ù…Ø¨ÙŠØ¹Ø§ØªÙƒ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©!';
                    },1400);
                }).catch(()=> {
                    // fallback: alert
                    alert(text);
                });
            } catch(e){
                alert(text);
            }
        }

        // Ù‚Ù… Ø¨ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø¹Ù†Ø¯ Ø£ÙˆÙ„ ØªØ­Ù…ÙŠÙ„
        window.onload = function() {
            toggleGuide();
            // Ø­Ù…Ù„ Ø£ÙØ¶Ù„ Ù†ØªÙŠØ¬Ø© Ù…Ø­Ù„ÙŠØ©
            loadBestScore();
            // Ù„Ø¶Ù…Ø§Ù† Ø¹Ø±Ø¶ Ø£ÙŠ ÙƒØ£Ø³ ØªÙ… ØªØ­Ù‚ÙŠÙ‚Ù‡ Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© (Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©)
            checkTrophy(gameState.totalSold); 
            updateUI();
        }
        
        // Ensure price adjustment stops when mouse/touch leaves button area
        document.addEventListener('mouseup', stopPriceAdjust);
        document.addEventListener('touchend', stopPriceAdjust);
        document.addEventListener('touchcancel', stopPriceAdjust);

    </script>
</body>
</html>
